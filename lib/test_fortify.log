ok: unsafe strlcpy() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-strlcpy.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strlcpy.c:5:
In function 'strlcpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:255:4: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
    __write_overflow();
    ^~~~~~~~~~~~~~~~~~
ok: unsafe strncpy() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-strncpy-src.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strncpy-src.c:5:
In function 'strncpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:148:3: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
   __write_overflow();
   ^~~~~~~~~~~~~~~~~~
ok: unsafe memcmp() usage correctly detected with '__read_overflow' in lib/test_fortify/read_overflow-memcmp.c
lib/test_fortify/test_fortify.h: In function 'do_fortify_tests':
lib/test_fortify/read_overflow-memcmp.c:3:2: error: statement with no effect [-Werror=unused-value]
  memcmp(small, large, sizeof(small) + 1)
  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
lib/test_fortify/test_fortify.h:34:2: note: in expansion of macro 'TEST'
  TEST;
  ^~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow-memcmp.c:5:
In function 'memcmp',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:722:4: error: call to '__read_overflow' declared with attribute error: detected read beyond size of object (1st parameter)
    __read_overflow();
    ^~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe memmove() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-memmove.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-memmove.c:5:
lib/test_fortify/test_fortify.h: In function 'do_fortify_tests':
./include/linux/fortify-string.h:58:30: error: '__builtin_memcpy' forming offset [25, 36] is out of the bounds [0, 24] of object 'instance' with type 'struct fortify_object' [-Werror=array-bounds]
 #define __underlying_memmove __builtin_memmove
                              ^
./include/linux/fortify-string.h:648:2: note: in expansion of macro '__underlying_memmove'
  __underlying_##op(p, q, __fortify_size);   \
  ^~~~~~~~~~~~~
./include/linux/fortify-string.h:697:27: note: in expansion of macro '__fortify_memcpy_chk'
 #define memmove(p, q, s)  __fortify_memcpy_chk(p, q, s,   \
                           ^~~~~~~~~~~~~~~~~~~~
lib/test_fortify/write_overflow-memmove.c:3:2: note: in expansion of macro 'memmove'
  memmove(instance.buf, large_src, sizeof(large_src))
  ^~~~~~~
lib/test_fortify/test_fortify.h:34:2: note: in expansion of macro 'TEST'
  TEST;
  ^~~~
In file included from lib/test_fortify/write_overflow-memmove.c:5:
lib/test_fortify/test_fortify.h:24:23: note: 'instance' declared here
 struct fortify_object instance;
                       ^~~~~~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-memmove.c:5:
In function 'fortify_memcpy_chk',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:576:4: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
    __write_overflow();
    ^~~~~~~~~~~~~~~~~~
./include/linux/fortify-string.h:583:4: error: call to '__write_overflow_field' declared with attribute warning: detected write beyond size of field (1st parameter); maybe use struct_group()? [-Werror]
    __write_overflow_field(p_size_field, size);
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe memscan() usage correctly detected with '__read_overflow' in lib/test_fortify/read_overflow-memscan.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow-memscan.c:5:
In function 'memscan',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:708:3: error: call to '__read_overflow' declared with attribute error: detected read beyond size of object (1st parameter)
   __read_overflow();
   ^~~~~~~~~~~~~~~~~
ok: unsafe memcmp() usage correctly detected with '__read_overflow2' in lib/test_fortify/read_overflow2-memcmp.c
lib/test_fortify/test_fortify.h: In function 'do_fortify_tests':
lib/test_fortify/read_overflow2-memcmp.c:3:2: error: statement with no effect [-Werror=unused-value]
  memcmp(large, small, sizeof(small) + 1)
  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
lib/test_fortify/test_fortify.h:34:2: note: in expansion of macro 'TEST'
  TEST;
  ^~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow2-memcmp.c:5:
In function 'memcmp',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:724:4: error: call to '__read_overflow2' declared with attribute error: detected read beyond size of object (2nd parameter)
    __read_overflow2();
    ^~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe memcpy() usage correctly detected with '__read_overflow2_field' in lib/test_fortify/read_overflow2_field-memcpy.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow2_field-memcpy.c:5:
In function 'fortify_memcpy_chk',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:592:4: error: call to '__read_overflow2_field' declared with attribute warning: detected read beyond size of field (2nd parameter); maybe use struct_group()? [-Werror]
    __read_overflow2_field(q_size_field, size);
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe memchr_inv() usage correctly detected with '__read_overflow' in lib/test_fortify/read_overflow-memchr_inv.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow-memchr_inv.c:5:
In function 'memchr_inv',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:749:3: error: call to '__read_overflow' declared with attribute error: detected read beyond size of object (1st parameter)
   __read_overflow();
   ^~~~~~~~~~~~~~~~~
ok: unsafe strscpy() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-strscpy.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strscpy.c:5:
In function 'strscpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:308:3: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
   __write_overflow();
   ^~~~~~~~~~~~~~~~~~
ok: unsafe strcpy() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-strcpy-lit.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strcpy-lit.c:5:
In function 'strcpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:798:3: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
   __write_overflow();
   ^~~~~~~~~~~~~~~~~~
ok: unsafe memcpy() usage correctly detected with '__write_overflow_field' in lib/test_fortify/write_overflow_field-memcpy.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow_field-memcpy.c:5:
In function 'fortify_memcpy_chk',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:583:4: error: call to '__write_overflow_field' declared with attribute warning: detected write beyond size of field (1st parameter); maybe use struct_group()? [-Werror]
    __write_overflow_field(p_size_field, size);
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe memmove() usage correctly detected with '__read_overflow2' in lib/test_fortify/read_overflow2-memmove.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow2-memmove.c:5:
lib/test_fortify/test_fortify.h: In function 'do_fortify_tests':
./include/linux/fortify-string.h:58:30: error: '__builtin_memcpy' forming offset [25, 36] is out of the bounds [0, 24] of object 'instance' with type 'struct fortify_object' [-Werror=array-bounds]
 #define __underlying_memmove __builtin_memmove
                              ^
./include/linux/fortify-string.h:648:2: note: in expansion of macro '__underlying_memmove'
  __underlying_##op(p, q, __fortify_size);   \
  ^~~~~~~~~~~~~
./include/linux/fortify-string.h:697:27: note: in expansion of macro '__fortify_memcpy_chk'
 #define memmove(p, q, s)  __fortify_memcpy_chk(p, q, s,   \
                           ^~~~~~~~~~~~~~~~~~~~
lib/test_fortify/read_overflow2-memmove.c:3:2: note: in expansion of macro 'memmove'
  memmove(large, instance.buf, sizeof(large))
  ^~~~~~~
lib/test_fortify/test_fortify.h:34:2: note: in expansion of macro 'TEST'
  TEST;
  ^~~~
In file included from lib/test_fortify/read_overflow2-memmove.c:5:
lib/test_fortify/test_fortify.h:24:23: note: 'instance' declared here
 struct fortify_object instance;
                       ^~~~~~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow2-memmove.c:5:
In function 'fortify_memcpy_chk',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:579:4: error: call to '__read_overflow2' declared with attribute error: detected read beyond size of object (2nd parameter)
    __read_overflow2();
    ^~~~~~~~~~~~~~~~~~
./include/linux/fortify-string.h:592:4: error: call to '__read_overflow2_field' declared with attribute warning: detected read beyond size of field (2nd parameter); maybe use struct_group()? [-Werror]
    __read_overflow2_field(q_size_field, size);
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe memmove() usage correctly detected with '__write_overflow_field' in lib/test_fortify/write_overflow_field-memmove.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow_field-memmove.c:5:
In function 'fortify_memcpy_chk',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:583:4: error: call to '__write_overflow_field' declared with attribute warning: detected write beyond size of field (1st parameter); maybe use struct_group()? [-Werror]
    __write_overflow_field(p_size_field, size);
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe memcpy() usage correctly detected with '__read_overflow2' in lib/test_fortify/read_overflow2-memcpy.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow2-memcpy.c:5:
lib/test_fortify/test_fortify.h: In function 'do_fortify_tests':
./include/linux/fortify-string.h:57:29: error: '__builtin_memcpy' forming offset [25, 36] is out of the bounds [0, 24] of object 'instance' with type 'struct fortify_object' [-Werror=array-bounds]
 #define __underlying_memcpy __builtin_memcpy
                             ^
./include/linux/fortify-string.h:648:2: note: in expansion of macro '__underlying_memcpy'
  __underlying_##op(p, q, __fortify_size);   \
  ^~~~~~~~~~~~~
./include/linux/fortify-string.h:693:26: note: in expansion of macro '__fortify_memcpy_chk'
 #define memcpy(p, q, s)  __fortify_memcpy_chk(p, q, s,   \
                          ^~~~~~~~~~~~~~~~~~~~
lib/test_fortify/read_overflow2-memcpy.c:3:2: note: in expansion of macro 'memcpy'
  memcpy(large, instance.buf, sizeof(large))
  ^~~~~~
lib/test_fortify/test_fortify.h:34:2: note: in expansion of macro 'TEST'
  TEST;
  ^~~~
In file included from lib/test_fortify/read_overflow2-memcpy.c:5:
lib/test_fortify/test_fortify.h:24:23: note: 'instance' declared here
 struct fortify_object instance;
                       ^~~~~~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow2-memcpy.c:5:
In function 'fortify_memcpy_chk',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:579:4: error: call to '__read_overflow2' declared with attribute error: detected read beyond size of object (2nd parameter)
    __read_overflow2();
    ^~~~~~~~~~~~~~~~~~
./include/linux/fortify-string.h:592:4: error: call to '__read_overflow2_field' declared with attribute warning: detected read beyond size of field (2nd parameter); maybe use struct_group()? [-Werror]
    __read_overflow2_field(q_size_field, size);
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe memset() usage correctly detected with '__write_overflow_field' in lib/test_fortify/write_overflow_field-memset.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow_field-memset.c:5:
In function 'fortify_memset_chk',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:493:4: error: call to '__write_overflow_field' declared with attribute warning: detected write beyond size of field (1st parameter); maybe use struct_group()? [-Werror]
    __write_overflow_field(p_size_field, size);
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe memchr() usage correctly detected with '__read_overflow' in lib/test_fortify/read_overflow-memchr.c
lib/test_fortify/test_fortify.h: In function 'do_fortify_tests':
lib/test_fortify/read_overflow-memchr.c:3:2: error: statement with no effect [-Werror=unused-value]
  memchr(small, 0x7A, sizeof(small) + 1)
  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
lib/test_fortify/test_fortify.h:34:2: note: in expansion of macro 'TEST'
  TEST;
  ^~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow-memchr.c:5:
In function 'memchr',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:737:3: error: call to '__read_overflow' declared with attribute error: detected read beyond size of object (1st parameter)
   __read_overflow();
   ^~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe strcpy() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-strcpy.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strcpy.c:5:
In function 'strcpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:65:29: error: '__builtin_memcpy' forming offset [17, 32] is out of the bounds [0, 16] of object 'small' with type 'char[16]' [-Werror=array-bounds]
 #define __underlying_strcpy __builtin_strcpy
                             ^
./include/linux/fortify-string.h:794:10: note: in expansion of macro '__underlying_strcpy'
   return __underlying_strcpy(p, q);
          ^~~~~~~~~~~~~~~~~~~
In file included from lib/test_fortify/write_overflow-strcpy.c:5:
lib/test_fortify/write_overflow-strcpy.c: In function 'do_fortify_tests':
lib/test_fortify/test_fortify.h:22:6: note: 'small' declared here
 char small[__BUF_SMALL];
      ^~~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strcpy.c:5:
In function 'strcpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:57:29: error: '__builtin_memcpy' forming offset [17, 32] is out of the bounds [0, 16] of object 'small' with type 'char[16]' [-Werror=array-bounds]
 #define __underlying_memcpy __builtin_memcpy
                             ^
./include/linux/fortify-string.h:802:2: note: in expansion of macro '__underlying_memcpy'
  __underlying_memcpy(p, q, size);
  ^~~~~~~~~~~~~~~~~~~
In file included from lib/test_fortify/write_overflow-strcpy.c:5:
lib/test_fortify/write_overflow-strcpy.c: In function 'do_fortify_tests':
lib/test_fortify/test_fortify.h:22:6: note: 'small' declared here
 char small[__BUF_SMALL];
      ^~~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strcpy.c:5:
In function 'strcpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:798:3: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
   __write_overflow();
   ^~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe memmove() usage correctly detected with '__read_overflow2_field' in lib/test_fortify/read_overflow2_field-memmove.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/read_overflow2_field-memmove.c:5:
In function 'fortify_memcpy_chk',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:592:4: error: call to '__read_overflow2_field' declared with attribute warning: detected read beyond size of field (2nd parameter); maybe use struct_group()? [-Werror]
    __read_overflow2_field(q_size_field, size);
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe strncpy() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-strncpy.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strncpy.c:5:
In function 'strncpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:148:3: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
   __write_overflow();
   ^~~~~~~~~~~~~~~~~~
ok: unsafe memset() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-memset.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-memset.c:5:
In function 'fortify_memset_chk',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:489:4: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
    __write_overflow();
    ^~~~~~~~~~~~~~~~~~
./include/linux/fortify-string.h:493:4: error: call to '__write_overflow_field' declared with attribute warning: detected write beyond size of field (1st parameter); maybe use struct_group()? [-Werror]
    __write_overflow_field(p_size_field, size);
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
ok: unsafe strlcpy() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-strlcpy-src.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strlcpy-src.c:5:
In function 'strlcpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:255:4: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
    __write_overflow();
    ^~~~~~~~~~~~~~~~~~
ok: unsafe memcpy() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-memcpy.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-memcpy.c:5:
lib/test_fortify/test_fortify.h: In function 'do_fortify_tests':
./include/linux/fortify-string.h:57:29: error: '__builtin_memcpy' forming offset [25, 36] is out of the bounds [0, 24] of object 'instance' with type 'struct fortify_object' [-Werror=array-bounds]
 #define __underlying_memcpy __builtin_memcpy
                             ^
./include/linux/fortify-string.h:648:2: note: in expansion of macro '__underlying_memcpy'
  __underlying_##op(p, q, __fortify_size);   \
  ^~~~~~~~~~~~~
./include/linux/fortify-string.h:693:26: note: in expansion of macro '__fortify_memcpy_chk'
 #define memcpy(p, q, s)  __fortify_memcpy_chk(p, q, s,   \
                          ^~~~~~~~~~~~~~~~~~~~
lib/test_fortify/write_overflow-memcpy.c:3:2: note: in expansion of macro 'memcpy'
  memcpy(instance.buf, large_src, sizeof(large_src))
  ^~~~~~
lib/test_fortify/test_fortify.h:34:2: note: in expansion of macro 'TEST'
  TEST;
  ^~~~
In file included from lib/test_fortify/write_overflow-memcpy.c:5:
lib/test_fortify/test_fortify.h:24:23: note: 'instance' declared here
 struct fortify_object instance;
                       ^~~~~~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-memcpy.c:5:
In function 'fortify_memcpy_chk',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:576:4: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
    __write_overflow();
    ^~~~~~~~~~~~~~~~~~
./include/linux/fortify-string.h:583:4: error: call to '__write_overflow_field' declared with attribute warning: detected write beyond size of field (1st parameter); maybe use struct_group()? [-Werror]
    __write_overflow_field(p_size_field, size);
    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
