ok: unsafe strcpy() usage correctly detected with '__write_overflow' in lib/test_fortify/write_overflow-strcpy.c
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strcpy.c:5:
In function 'strcpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:65:29: error: '__builtin_memcpy' forming offset [17, 32] is out of the bounds [0, 16] of object 'small' with type 'char[16]' [-Werror=array-bounds]
 #define __underlying_strcpy __builtin_strcpy
                             ^
./include/linux/fortify-string.h:794:10: note: in expansion of macro '__underlying_strcpy'
   return __underlying_strcpy(p, q);
          ^~~~~~~~~~~~~~~~~~~
In file included from lib/test_fortify/write_overflow-strcpy.c:5:
lib/test_fortify/write_overflow-strcpy.c: In function 'do_fortify_tests':
lib/test_fortify/test_fortify.h:22:6: note: 'small' declared here
 char small[__BUF_SMALL];
      ^~~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strcpy.c:5:
In function 'strcpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:57:29: error: '__builtin_memcpy' forming offset [17, 32] is out of the bounds [0, 16] of object 'small' with type 'char[16]' [-Werror=array-bounds]
 #define __underlying_memcpy __builtin_memcpy
                             ^
./include/linux/fortify-string.h:802:2: note: in expansion of macro '__underlying_memcpy'
  __underlying_memcpy(p, q, size);
  ^~~~~~~~~~~~~~~~~~~
In file included from lib/test_fortify/write_overflow-strcpy.c:5:
lib/test_fortify/write_overflow-strcpy.c: In function 'do_fortify_tests':
lib/test_fortify/test_fortify.h:22:6: note: 'small' declared here
 char small[__BUF_SMALL];
      ^~~~~
In file included from ./include/linux/string.h:254,
                 from ./include/linux/bitmap.h:11,
                 from ./include/linux/cpumask.h:12,
                 from ./arch/x86/include/asm/paravirt.h:17,
                 from ./arch/x86/include/asm/cpuid.h:62,
                 from ./arch/x86/include/asm/processor.h:19,
                 from ./arch/x86/include/asm/cpufeature.h:5,
                 from ./arch/x86/include/asm/thread_info.h:53,
                 from ./include/linux/thread_info.h:60,
                 from ./arch/x86/include/asm/preempt.h:9,
                 from ./include/linux/preempt.h:79,
                 from ./include/linux/spinlock.h:56,
                 from ./include/linux/mmzone.h:8,
                 from ./include/linux/gfp.h:7,
                 from ./include/linux/slab.h:16,
                 from lib/test_fortify/test_fortify.h:4,
                 from lib/test_fortify/write_overflow-strcpy.c:5:
In function 'strcpy',
    inlined from 'do_fortify_tests' at lib/test_fortify/test_fortify.h:34:2:
./include/linux/fortify-string.h:798:3: error: call to '__write_overflow' declared with attribute error: detected write beyond size of object (1st parameter)
   __write_overflow();
   ^~~~~~~~~~~~~~~~~~
cc1: all warnings being treated as errors
